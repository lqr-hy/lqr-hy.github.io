import React from 'react';
import { Button, Space, message } from 'antd';
import { DownloadOutlined } from '@ant-design/icons';
import * as XLSX from 'xlsx';

const CreateSampleData: React.FC = () => {
  // 生成示例快递数据 - 基于真实的在仓问题件格式
  const createSampleData = () => {
    const sampleData = [
      // 第一行作为表头
      ['中通', '申通', '圆通', '韵达', '邮政', '德邦', '其他1', '其他2'],
      // 数据行 - 模拟真实快递单号格式
      ['75761365043766', '77632957076153', 'YT894185215852', '46334069260168', '98574940403', '', '78420955356386', ''],
      ['75761370314853', '77716951501759', 'YT893990509270', '31866359263298', '98560526232', '9859804263924', 'YT186462915172', '76404551359033'],
      ['75761778084401', '77718014846666', 'YT893963976843', '46287276652932', '98536949291', '78429704052379', '75927435518902', 'YT187408071234'],
      ['75701252115546', '77637759935866', 'YT894201069876', '31843064579230', '97296408178', 'YT186280065', '75784511173146', '66359891804539'],
      ['73758542663334', '77637670960391', 'YT895049397612', '43346575840625', '98575975895', '75787813512919', '46354663605339', '76402338483964'],
      ['75759771633297', '77716735072358', 'YT184462463248', '31223997209447', '98568749683', '46357146000564', '78415774316964', '77639859092129'],
      ['75720421323714', '77719027075196', 'YT184457681467', '31809691879016', '98579492589', 'YT341200744387', 'YT897335722067', 'YT187233501979'],
      ['73512419564761', '77637671981249', 'YT893818278100', '46331020574805', '97205881496', 'YT341201677714', '75783910243023', '73611936305049'],
      ['78348589711072', '77717048858591', 'YT894977023640', '46327642836256', '98579559330', '94237681792610', '77721355400769', 'YT187138534774'],
      ['78395625164772', '77718949652111', 'YT894961866853', '46321563170625', '98579435870', '73610758175011', 'YT897320061987', '75927949438370']
    ];

    return sampleData;
  };

  // 下载示例Excel文件
  const downloadSampleExcel = () => {
    try {
      const data = createSampleData();
      const ws = XLSX.utils.aoa_to_sheet(data); // 使用aoa_to_sheet处理二维数组
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, '在仓问题件');
      
      // 设置列宽
      const wscols = [
        { wch: 15 }, // 中通
        { wch: 15 }, // 申通
        { wch: 15 }, // 圆通
        { wch: 15 }, // 韵达
        { wch: 15 }, // 邮政
        { wch: 15 }, // 德邦
        { wch: 15 }, // 其他1
        { wch: 15 }  // 其他2
      ];
      ws['!cols'] = wscols;
      
      XLSX.writeFile(wb, '在仓问题件.xlsx');
      message.success('示例Excel文件已下载！');
    } catch (error) {
      message.error('生成示例文件失败');
      console.error('Error creating sample file:', error);
    }
  };

  return (
    <Space>
      <Button 
        type="primary" 
        icon={<DownloadOutlined />} 
        onClick={downloadSampleExcel}
      >
        下载示例Excel文件
      </Button>
    </Space>
  );
};

export default CreateSampleData;
